# AUTOGENERATED! DO NOT EDIT! File to edit: ../notebooks/01_dataset.ipynb.

# %% auto 0
__all__ = ['ds_dir', 'create_image_file_list', 'create_labels_file_list', 'create_dataset_list', 'print_ds_info']

# %% ../notebooks/01_dataset.ipynb 2
from pathlib import Path
import os
import cv2
import json
import IPython
import matplotlib.pyplot as plt
from skimage.feature import hog
from random import randint
from PIL import Image

from skimage import data, exposure

from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import accuracy_score, confusion_matrix

import seaborn as sns

import numpy as np

# %% ../notebooks/01_dataset.ipynb 4
ds_dir = Path("../data")
ds_dir.absolute()

# %% ../notebooks/01_dataset.ipynb 6
def create_image_file_list(ds_dir):
    imgs_files = os.listdir(ds_dir.absolute() / "img")
    imgs_files_path = ds_dir / "img"

    imgs_ds = []
    for f in imgs_files:
        imgs_ds.append(os.path.join(ds_dir, f"img/{f}"))
    imgs_ds.sort()
    return imgs_ds

# %% ../notebooks/01_dataset.ipynb 8
def create_labels_file_list(ds_dir):
    lbls_files = os.listdir(ds_dir.absolute() / "ann")
    lbls_files_path = ds_dir / "ann"

    lbls_ds = []
    for f in lbls_files:
        lbls_ds.append(os.path.join(ds_dir, f"ann/{f}"))
    lbls_ds.sort()
    return lbls_ds

# %% ../notebooks/01_dataset.ipynb 10
def create_dataset_list(ds_dir=ds_dir):
    images_list = create_image_file_list(ds_dir)
    labels_list = create_labels_file_list(ds_dir)
    # Create dataset list[<img file>, <label>]
    ds = []
    for img, lbl in zip(images_list, labels_list):
        with open(lbl) as f:
            l = ""
            d = str(json.load(f))
            if "weed" in d:
                l = "weed"
            elif "crop" in d:
                l = "crop"
            ds.append([img, l])
    return ds

# %% ../notebooks/01_dataset.ipynb 12
def print_ds_info(ds):
    # How many of each {weed, crop}
    nof_weeds = len([row[1] for row in ds if row[1] == "weed"])
    nof_crops = len([row[1] for row in ds if row[1] == "crop"])
    print(f"Nof weed samples: {nof_weeds}")
    print(f"Nof crop samples: {nof_crops}")
